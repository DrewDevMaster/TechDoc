//
//  Random.swift
//  TechAddicted
//
//  Created by Drew on 17.06.2025.
//

import Foundation

/*
 1. –ß—Ç–æ —Ç–∞–∫–æ–µ ARC?
 
 ARC (Automatic Reference Counting) ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é –≤ Swift –∏ Objective-C, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Å—ã–ª–æ–∫ –Ω–∞ –æ–±—ä–µ–∫—Ç—ã –≤ –ø–∞–º—è—Ç–∏ –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –∏—Ö, –∫–æ–≥–¥–∞ –æ–Ω–∏ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã.

 ‚∏ª

 üì¶ –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:

 –ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –≤ Swift –∏–º–µ–µ—Ç —Å—á—ë—Ç—á–∏–∫ —Å—Å—ã–ª–æ–∫ (reference count).
 –ö–æ–≥–¥–∞ —Ç—ã —Å–æ–∑–¥–∞—ë—à—å –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—ë—à—å —Å—Å—ã–ª–∫—É –Ω–∞ –æ–±—ä–µ–∫—Ç:
     ‚Ä¢    üîº —Å—á—ë—Ç—á–∏–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è (+1)
     ‚Ä¢    üîΩ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å—Å—ã–ª–∫–∏ ‚Äî —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è (-1)
     ‚Ä¢    ‚ùå –∫–æ–≥–¥–∞ —Å—á—ë—Ç—á–∏–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è 0, –æ–±—ä–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –ø–∞–º—è—Ç–∏
 */

 class PersonClass {
     var name: String
     init(name: String) {
         self.name = name
         print("\(name) –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
     }

     deinit {
         print("\(name) —É–¥–∞–ª—ë–Ω –∏–∑ –ø–∞–º—è—Ç–∏")
     }
 }

 var person1: PersonClass? = PersonClass(name: "Anna")
 var person2 = person1 // +1

private func test() {
    person1 = nil // -1, –Ω–æ –æ–±—ä–µ–∫—Ç –µ—â—ë –≤ –ø–∞–º—è—Ç–∏
    person2 = nil // -1, —Ç–µ–ø–µ—Ä—å —Å—á—ë—Ç—á–∏–∫ 0 => deinit
}
 
/*
 üß® –ü—Ä–æ–±–ª–µ–º–∞: –¶–∏–∫–ª—ã —Å–∏–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ (retain cycles)

–ï—Å–ª–∏ –¥–≤–∞ –æ–±—ä–µ–∫—Ç–∞ —Å—Å—ã–ª–∞—é—Ç—Å—è –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞, –æ–Ω–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Å–≤–æ–±–æ–¥—è—Ç—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–∏–∫—Ç–æ –∏–∑–≤–Ω–µ –∏—Ö –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç.

–ü—Ä–∏–º–µ—Ä retain cycle:
*/

private class A {
    var b: B?
}

private class B {
    var a: A?
}

private func test1() {
    let a = A()
    let b = B()
    a.b = b
    b.a = a // üîÅ —Ü–∏–∫–ª
}

/*
 üîß –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å weak –∏–ª–∏ unowned —Å—Å—ã–ª–∫–∏.
 üß† –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã:
 
 –¢–µ—Ä–º–∏–Ω
 –ó–Ω–∞—á–µ–Ω–∏–µ
 strong
 –û–±—ã—á–Ω–∞—è —Å—Å—ã–ª–∫–∞, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫
 weak
 –ù–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å optional, –Ω–µ —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±—ä–µ–∫—Ç
 unowned
 –ù–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫, –Ω–æ –Ω–µ optional. –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç —É–¥–∞–ª—ë–Ω ‚Äî –∫—Ä–∞—à

 üìå ARC —É–ø—Ä–∞–≤–ª—è–µ—Ç:
     ‚Ä¢    –∫–ª–∞—Å—Å–∞–º–∏ (class)
     ‚Ä¢    —Å—Å—ã–ª–∫–∞–º–∏ (var, let, –º–∞—Å—Å–∏–≤—ã —Å—Å—ã–ª–æ–∫)
     ‚Ä¢    closures, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç self
*/
